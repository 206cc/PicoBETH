# 維護與日誌管理指南

## 保養維護

### 螺杆保養

每次使用時需觀察是否有不正常的振動或噪音，並每個月進行目視檢查螺杆狀況。檢查螺杆是否沾有灰塵或異物，確認潤滑狀況是否良好。如果螺杆周圍出現黃褐色潤滑油並且行走面呈現光滑現象，表示潤滑狀況正常。滾珠螺桿的潤滑油粘度建議為 30~40 cSt。

### 零件更換

如有維修或更換元件後，可在開機時進入硬體測試模式，以重新檢測所有元件是否正常。

使用方式：在開機時顯示版本資訊時，長按設定中鍵直到聽見長音後放開。

> **重要提示**  
> 如有更換硬體零件，務必執行 **硬體測試模式** 檢查所有功能是否正常。

### 出廠設定

可透過不連接電腦的方式重新建立 `config.cfg`，恢復出廠預設值（原設定檔會更名為 `config.cfg.bak`）。恢復預設後，請務必重新校正 HX 張力參數。

使用方式：在開機顯示版本資訊時，長按離開鍵直到聽見長音後放開。

參考影片：[![DEMO](https://img.youtube.com/vi/iAgFXuEtak4/0.jpg)](https://www.youtube.com/watch?v=iAgFXuEtak4)

### 韌體更新

進行韌體更新時，請依照以下步驟操作：

1. **備份 Raspberry Pi Pico 上的所有檔案至電腦**。
2. **上傳新版本的 `main.py` 至 Raspberry Pi Pico**。
3. [**執行硬體測試**](2.Hardware_Setup.cht.md#%E7%A1%AC%E9%AB%94%E6%B8%AC%E8%A9%A6%E6%A8%A1%E5%BC%8F)
4. [**進行可靠度測試**](2.Hardware_Setup.cht.md#%E5%8F%AF%E9%9D%A0%E5%BA%A6%E6%B8%AC%E8%A9%A6)
5. **用舊的球拍至少試穿一次**。

> **重要提示**  
> 以上步驟均不可省略。

## 日誌系統

從 V2.5 版本開始，系統加入了簡易的日誌系統，用於幫助排除故障、記錄重要事件，並提供日後查閱和分析的依據。

### 系統日誌 `sys_log.txt`

此日誌檔案需透過電腦檢視。可以使用內建的 `logs_save()` 函數自訂日誌存儲位置，當記錄檔達到 100KB 時，系統會自動更名並覆寫。

**格式：**
```
觸發 function: 總張緊計數 / 自訂資訊
```

**示例：**
```
init(HX711):55863T/21188/21465/401/90
forward():55863T/No String?
start_tensioning():55863T/ts_err#0
forward():55863T/No String?
start_tensioning():55863T/ts_err#0
init(HX711):55863T/21188/21493/487/90
```

### 穿線記錄 `logs.txt`

此記錄檔可直接在 LCD 上查看，最大記錄值為 `LOG_MAX` 定義參數。

**格式：**
```
總張緊計數, 計時器時間, 張力單位, 設定張力 (LB), 最大張力 (G), 預拉 (%), 張緊時間, 恆拉增加張力次數, 恆拉減少張力次數, 張力參數, 張力校正參數, FT 參數, 打結功能 SW, 打結 (%)
```

**示例：**
```
60384,72719,1,21,10477,10,3,0,0,1.03852,18.17,1,0,15
60385,72736,1,22,10976,10,3,0,37,1.048519,18.17,1,0,15
60386,72753,1,23,11475,10,3,4,23,1.03852,18.17,1,0,15
60387,72770,1,24,11974,10,3,5,41,1.02852,18.17,1,0,15
60388,72785,1,25,12473,10,3,7,43,1.03852,18.17,1,0,15
60389,72803,1,26,12972,10,3,6,49,1.048519,18.17,1,0,15
```

### 可靠度測試記錄 `rt_logs.txt`

此記錄檔需透過電腦檢視，當測試次數達到 1000 次時，系統會自動更名並覆寫。

**格式：**
```
可靠度測試計數 / 總張緊計數 / 自動張力參數 / 測試張力參數 / 張緊完成時間 (秒)
```

**示例：**
```
4521/60384T/1.03/0.97/13
4522/60385T/1.04/0.97/12
4523/60386T/1.05/0.97/13
4524/60387T/1.04/0.97/13
4525/60388T/1.03/0.97/12
4526/60389T/1.04/0.97/13
```